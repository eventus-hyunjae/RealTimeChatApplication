@{
    ViewBag.Title = "Chat";
}
<h2>Chat</h2>
<div id="app">
    @*<input type="text" id="message" />*@
    <input v-model="message"/>
    <!--<input type="button"--> @*id="sendmessage"*@ <!--v-on:click="sendMessage" value="Send" />-->
    <button @@click="sendMessage">Send</button>
    <input type="hidden" id="displayname" v-model="userName"/>
    <ul id="discussion">
    </ul>
</div>
@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>           
        var chat = $.connection.chatHub;
        var app = new Vue({
            el: '#app',
            data: {
                userName: "",
                message : "",
                chats : []
            },
            mounted() {     
                var self = this;
                chat.client.addNewMessageToPage = function (name, message) {
                    console.log(name, message);
                };
                $.connection.hub.start().done(function () {

                   
                    self.message = "";
                });
                self.userName = prompt('이름을 입력하세요:', '');
            },
            methods: {
                sendMessage() {

                    let self = this;
                    chat.server.send(self.userName, self.message);
                    console.log(chat)
                },

                update() {
                    let encodedValue = $('<div />').text(value).html();
                    return encodedValue;
                }
            }
        })
    </script>
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            
            // Create a function that the hub can call back to display messages.

        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>
}